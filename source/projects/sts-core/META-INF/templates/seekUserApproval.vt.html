<!DOCTYPE html>
<html>
	<head>
		<!-- Latest compiled and minified JavaScript -->
		<script src="http://code.jquery.com/jquery-1.9.0.js"></script>
		<script src="http://code.jquery.com/jquery-migrate-1.2.1.js"></script>
		<!-- Latest compiled and minified CSS -->
		<!-- Latest compiled and minified CSS -->
		<link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css">

		<!-- Optional theme -->
		<link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-theme.min.css">

		<!-- Latest compiled and minified JavaScript -->
		<script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>
		<script>
			function handleSubmission(action)
			{
				if(action == 'accept')
				{
					var payload = {};
					payload.decision = true;
					payload.optionalAttributes =[];
					$("input[name='attributes']:checked").each(
						function() {
							payload.optionalAttributes.push($(this).attr('value'));
						}
					);
					
					$("input[name='response']").attr('value', JSON.stringify(payload));
					console.log(JSON.stringify(payload));
					$("#submissionForm").submit();
				}
				else if(action =='cancel')
				{
					var payload = {};
					payload.decision = false;
					$("input[name='response']").attr('value', JSON.stringify(payload));
					console.log(JSON.stringify(payload));
					$("#submissionForm").submit();
				}
				else
				{
					console.log("Unknown action");
				}
			}
		</script>
		
	</head>
	<title>Rakshak - Authorize Access</title>
	<body>
		<div class="row" header >
			<div class="col-lg-1" left-margin>

			</div>
			<div class="col-lg-10">

				<h1>Rakshak - Identity Server</h1>
				<h5>sytem build <code>
					1.0.0</code></h5>
				<hr />
			</div>
			<div class="col-lg-1" right-margin>

			</div>
		</div>
		<div class="row" body >
			<div class="col-lg-2" left-margin>

			</div>
			<div class="col-lg-8 ">
				<form id="submissionForm" method="post" action="?action=seekApproval">
					<fieldset>
						<legend>
							<h2>  <b class="text-info">$relyingParty</b> would like to : </h2>
						</legend>
						
						#foreach ($attribute in $attributeRequested.keySet())
							#if($attributeRequested.get($attribute) == false)
							<div class="well well-sm">
							<div class="checkbox">
    							<label>
						      		<input name="attributes" type="checkbox" value="$attribute.toString()"> <strong >View your $attribute.getCommonName()</strong>
						    	</label>
						    	<div class="text-info">$attribute.extractValue($user)</div>
						  	</div>
							</div>
							
							
							#else
							<div class="well well-sm">
    							<label>
						      		<strong>View your $attribute.getCommonName()</strong>
						    	</label>
						    	<div class="text-info">$attribute.extractValue($user)</div>
						  	</div>
								
							#end
						#end
						

							<input type="hidden" name="response">
							<input type="hidden" name="relyingParty" value="$relyingParty">
							<input type="hidden" name="action" value="seekApproval">
						
						<button  class="btn btn-primary" onclick="handleSubmission('accept');">
							Accept
						</button>
						<button  class="btn btn-danger" onclick="handleSubmission('cancel');">
							Cancel
						</button>
					</fieldset>
				</form>
			</div>
			<div class="col-lg-2" right-margin>

			</div>
		</div>
		 <div class="navbar navbar-fixed-bottom" footer>
								<hr />
					<div class="row">
						<div class="col-lg-1"></div>
						<div class="col-lg-10">
							<h6>Rakshak is an open sourced project produced by Department of Biomedical Informatics Emory University. Rakshak proudly uses following technologies and open standards :</h6>
						</div>
						<div class="col-lg-1"></div>
					</div>
					<div class="row">
						<div class="col-lg-1"></div>
						<div class="col-lg-1"><img src="http://upload.wikimedia.org/wikipedia/en/c/c8/OpenID_logo.svg" height="40" width="80" />
						</div>
						<div class="col-lg-1"><img src="http://hueniverse.com/wp-content/uploads/2010/05/OAuth2.png" height="40" width="50" />
						</div>
						<div class="col-lg-1"><img src="http://eugenedvorkin.com/wp-content/uploads/2012/02/draft-saml-logo-03.png" height="40" width="80" />
						</div>
						<div class="col-lg-1"><img src="http://www.osgi.org/wiki/uploads/Main/logo1.jpg" height="40" width="100" />
						</div>
						<div class="col-lg-8"></div>
					</div>

			</div>	

	</body>
</html>